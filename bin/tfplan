#!/usr/bin/env bash

# source tfcommon from same bin folder
. "`dirname $(realpath $0)`/tfcommon"

folder=${1:-.}

echo "checking $folder"

is_tf_folder $folder || exit 1

cd $folder
backend_params=$(setupbackend)

echo $backend_params

getcreds
set -x
terraform init $backend_params

terraform plan -out plan.tfplan
